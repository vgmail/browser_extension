for(var backgroundPage=chrome.extension.getBackgroundPage(),imports=["require","isWhitelisted","extractHostFromURL","refreshIconAndContextMenu"],i=0;i<imports.length;i++)window[imports[i]]=backgroundPage[imports[i]];var require=backgroundPage.require,getStats=require("stats").getStats,FilterNotifier=require("filterNotifier").FilterNotifier,Filter=require("filterClasses").Filter,FilterStorage=require("filterStorage").FilterStorage,Prefs=require("prefs").Prefs,Cscript=require("cscript").Cscript;with(require("subscriptionClasses"))this.Subscription=Subscription,this.DownloadableSubscription=DownloadableSubscription;$((function(){var e,i=null;function t(){var i=getStats("blocked",e).toLocaleString();$(".current-block-ad").html(i);var t=getStats("blocked").toLocaleString();$(".total-block-ad").html(t)}function o(e,i){"filter.hitCount"==e&&t()}function c(e){var i,t="广告终结者(Ad Terminator)——功能最全面的广告屏蔽扩展",o="http://www.adtchrome.com/img/download-slide2.jpg",c=encodeURIComponent("http://www.adtchrome.com");switch(e){case"sina-weibo":i="http://service.weibo.com/share/share.php?url="+c+"&appkey=&title="+t+"&pic="+o;break;case"qq-zone":i="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+c+"&desc=广告终结者(Ad Terminator)——功能最全面的广告屏蔽插件&title=广告终结者(Ad Terminator)&pic="+o;break;case"tenc-weibo":i="http://share.v.t.qq.com/index.php?c=share&a=index&url="+c+"&title="+t+"&appkey=&pic="+o;break;case"renren":i="http://widget.renren.com/dialog/share?resourceUrl="+c+"&message=广告终结者(Ad Terminator)——功能最全面的广告屏蔽插件&description=广告终结者可以清除所有网页广告，恶意弹窗，视频广告，跟踪代码，加快网页加载速度 &pic="+o}window.open(i)}!function(){chrome.windows.getCurrent((function(e){chrome.tabs.getSelected(e.id,(function(e){i=e,isWhitelisted(i.url)||($("#enable-block").addClass("checked"),$("#enable-block-text").show(),$("#disable-block-text").hide()),chrome.tabs.sendMessage(i.id,{reqtype:"get-clickhide-state"},(function(e){e&&e.active&&($(".main-menu").hide(0),$(".click-block").show(0))}))}))}));var e=Cscript.getScript("http://sub.adtchrome.com/videoadjs.txt");null!=e&&e.enabled&&($(".block-video-icon").toggleClass("checked"),$("#enable-video-block-text").toggle(),$("#disable-video-block-text").toggle())}(),chrome.tabs.query({active:!0,windowId:chrome.windows.WINDOW_ID_CURRENT},(function(i){i.length>0&&(e=i[0].id,t(),FilterNotifier.addListener(o))})),window.addEventListener("unload",(function(){FilterNotifier.removeListener(o)}),!1),$(".header").click((function(){$("#ad-statistic").show(),$("#menu").hide()})),$(".footer").click((function(){$("#ad-statistic").hide(),$("#menu").show()})),$(".checkbox-hoverhook").click((function(){$(this).find(".checkbox-green").toggleClass("checked"),$("#enable-block-text").toggle(),$("#disable-block-text").toggle(),function(e){if(e)for(var t=isWhitelisted(i.url);t;)FilterStorage.removeFilter(t),t.subscriptions.length&&(t.disabled=!0),t=isWhitelisted(i.url);else{var o=extractHostFromURL(i.url).replace(/^www\./,"");(t=Filter.fromText("@@||"+o+"^$document")).subscriptions.length&&t.disabled?t.disabled=!1:(t.disabled=!1,FilterStorage.addFilter(t))}refreshIconAndContextMenu(i)}($(this).find(".checkbox-green").hasClass("checked"))})),$(".click-block-video-hook").click((function(){var e;$(this).find(".block-video-icon").toggleClass("checked"),$("#enable-video-block-text").toggle(),$("#disable-video-block-text").toggle(),e=$(this).find(".block-video-icon").hasClass("checked"),Cscript.enable("http://sub.adtchrome.com/videoadjs.txt",e)})),$(".checkbox-hoverhook").hover((function(){$(this).find(".checkbox-green").addClass("hover")}),(function(){$(this).find(".checkbox-green").removeClass("hover")})),$(".option-hook").click((function(){window.close(),chrome.tabs.create({url:"options.html"})})),$(".click-help-hook").click((function(){window.open("http://www.adtchrome.com/help/index.html")})),$("#help-block").click((function(){window.open("http://www.adtchrome.com/help/help-block.html")})),$(".click-block-hook").click((function(){$(".main-menu").hide(),$(".click-block").show(),chrome.tabs.sendMessage(i.id,{reqtype:"clickhide-activate"}),$("body").bind("mouseleave",(function(){window.setTimeout(window.close,500)}))})),$("#click-block-cancel").click((function(){$("body").unbind("mouseleave"),chrome.tabs.sendMessage(i.id,{reqtype:"clickhide-deactivate"}),$(".main-menu").show(),$(".click-block").hide()})),$(".sina-weibo").click((function(){c("sina-weibo")})),$(".qq-zone").click((function(){c("qq-zone")})),$(".tenc-weibo").click((function(){c("tenc-weibo")})),$(".renren").click((function(){c("renren")}))}));