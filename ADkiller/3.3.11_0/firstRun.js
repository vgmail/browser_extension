var backgroundPage=chrome.extension.getBackgroundPage(),require=backgroundPage.require,subscriptionClasses=require("subscriptionClasses"),Subscription=subscriptionClasses.Subscription,FilterNotifier=require("filterNotifier").FilterNotifier,FilterStorage=require("filterStorage").FilterStorage,DownloadableSubscription=subscriptionClasses.DownloadableSubscription,Synchronizer=require("synchronizer").Synchronizer,Cscript=require("cscript").Cscript,fdownnum=0,alldown=1,_localStorage=localStorage;function getURLParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}var cc=0,pbs=0;function doprogress(){if(20!=cc){var e=100*(cc+1)/20;$(".progress-bar").css("width",e+"%"),cc+=1,setTimeout(doprogress,400)}else pbs=1}function addsubscription(){if((new Browser).browser.indexOf("360")>-1)var e="http://sub.adtchrome.com/adt-chinalist-easylist360.txt";else e="http://sub.adtchrome.com/adt-chinalist-easylist.txt";[{homepage:"http://www.adtchrome.com/extension/adt-chinalist-easylist.html",title:"广告终结者默认过滤规则",url:e,disabled:!1}].forEach((function(e){var o=Subscription.fromURL(e.url);FilterStorage.addSubscription(o),o.disabled=e.disabled,o.title=e.title,o.homepage=e.homepage,o instanceof DownloadableSubscription&&!o.lastDownload&&Synchronizer.execute(o)})),Cscript.add("去视频广告脚本","http://sub.adtchrome.com/videoadjs.txt")}function getBroswerType(){if(navigator.userAgent.toLowerCase().indexOf("lbbrowser")>0)return"lbbrowser";var e="track"in document.createElement("track"),o="scoped"in document.createElement("style"),t="v8Locale"in window;return e&&o&&t?"360se":e&&o&&!t?"360ee":"chrome"}doprogress(),addsubscription(),function(e){e.fn.extend({center:function(o){o=e.extend({inside:window,transition:0,minX:0,minY:0,withScrolling:!0,vertical:!0,horizontal:!0},o);return this.each((function(){var t={position:"absolute"};if(o.vertical){var r=(e(o.inside).height()-e(this).outerHeight())/2;o.withScrolling&&(r+=e(o.inside).scrollTop()||0),r=r>o.minY?r:o.minY,e.extend(t,{top:r+"px"})}if(o.horizontal){var i=(e(o.inside).width()-e(this).outerWidth())/2;o.withScrolling&&(i+=e(o.inside).scrollLeft()||0),i=i>o.minX?i:o.minX,e.extend(t,{left:i+"px"})}return o.transition>0?e(this).animate(t,o.transition):e(this).css(t),e(this)}))}})}(jQuery),$((function(){function e(){$("body").removeClass("stop-scrolling"),$(".popboxbg").remove(),$(".popbox").remove()}$("#checkbox").change((function(){$("#checkbox").prop("checked")?_localStorage.privacy_policy=!0:_localStorage.removeItem("privacy_policy")})),$("#button").click((function(){let o=_localStorage.privacy_policy;o&&"true"==o?pbs?e():console.log("加载配置完成"):alert("请先勾选同意《隐私政策》")})),window.onbeforeunload=function(){if(!_localStorage.privacy_policy)return confirm("确定退出吗")},$("#checkbox").prop("checked",_localStorage.privacy_policy&&"true"==_localStorage.privacy_policy),$("#checkbox").prop("checked")?e():($("body").addClass("stop-scrolling"),$(".popbox").center(),$(window).bind("resize",(function(){$(".popbox").center({transition:300})}))),$(window).scroll((function(e){$(window).scrollTop()>69?$("#sideToolbar-up").fadeIn(100):$("#sideToolbar-up").fadeOut(100)})),$("#sideToolbar-up").click((function(e){$("body,html").animate({scrollTop:0},500)})),$("#"+getBroswerType()+"-warn").show(),null!=getURLParameter("test")&&($("body").removeClass("stop-scrolling"),$(".popboxbg").remove(),$(".popbox").remove())}));var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-48334954-1"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://ssl.google-analytics.com/ga.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(e,o)}();